---
author: amosk
comments: true
date: 2007-07-01 12:08:46+00:00
layout: post
slug: '%e5%b1%80%e5%9f%9f%e7%bd%91%e8%87%aa%e5%8a%a8%e6%90%9c%e7%b4%a2%e9%85%8d%e7%bd%ae%e4%bb%a3%e7%90%86%e6%9c%8d%e5%8a%a1%e5%99%a8'
title: 局域网自动搜索配置代理服务器
wordpress_id: 52
categories:
- Programming
- Web
---

前一段时间cocobear写了一个linux下的脚本，用来探测cnc拨号**，不过他那个比较费时间，而且会影响他人正常上网。最近我在win下用批处理写了一个程序，可以自动搜索并配置代理服务器，解决上网问题。当然这里只是做技术研究，请大家按照相关规章制度办理上网手续。 

考虑到法律和道德的约束问题，这里只将部分代码贴出来供大家研究学习。滥用程序带来的一切后果，由代码使用者本人承担！有任何想法请与我联系：[kongjianjun@gmail.com](mailto:kongjianjun@gmail.com)

if "%1"=="" (
set/a a=1
) else set/a a=%1-1
set b=0
if "%2"=="" (
set/a c=2
) else set/a c=%2-1

::netsh interface ip set address name="本地连接" source=static addr=192.168.%b%.24 mask=255.255.255.0 >nul && echo Gateway:  192.168.%b%.24
:up
if %a% == 255 goto panduan

:goon
set/a a=%a%+1
echo IP:  192.168.%b%.%a%
netsh interface ip set address name="本地连接" gateway=192.168.%b%.%a% gwmetric=0

::ping -n 1 220.181.37.4 |find "Reply from 220.181.37.4" >nul 2>nul && echo 大功告成! && echo 192.168.%b%.%a% >>host.txt && nbtstat -A

192.168.%b%.%a% >>host.txt && goto win
goto up
:panduan
set/a b=%b%+1
if "%b%" == "%c%" goto end
set/a a=1 && netsh interface ip set address name="本地连接" source=static addr=192.168.%b%.24 mask=255.255.255.0 >nul && echo Gateway: 

192.168.%b%.24  && goto goon
